package dataIO

import dataModel.DataPaths
import org.apache.spark.sql.SparkSession
import org.scalatest.funsuite.AnyFunSuite
import org.scalatest.{BeforeAndAfterAll, BeforeAndAfterEach}

class InputDataLoaderTest extends AnyFunSuite with BeforeAndAfterAll with BeforeAndAfterEach {

  val testInputFolder = "data/testData/cleanedData"
  val testUtilFolder = "data/utilDictionaries"
  val testModelsFolder = "models"

  val inputdataLoader = new InputDataLoader(DataPaths(testInputFolder, null, testUtilFolder, testModelsFolder))

  override protected def beforeAll() {
    val spark = SparkSession.builder.
      appName("SparkSessionExample").
      master("local[24]").
      getOrCreate
  }

  test("should load input dataframe correctly") {
    val result = inputdataLoader.loadInputDataFrame()
    val columnNames = result.schema.map(element => element.name)
    assert(columnNames === List("paperId", "paragraphIndex", "text"))
  }

  test("should load stop words correctly") {
    val result = inputdataLoader.loadStopWords()

    val expected = Array("two", "few", "abst", "full", "ff", "everywhere", "several", "would", "beginnings", "giving", "she'll", "same", "theres", "nowhere", "notwithstanding", "biol", "et", "having", "she's", "throughout", "important", "slightly", "vol", "uucp", "off", "who'll", "yourselves", "about", "rather", "also", "becoming", "keeps", "still", "rd", "beyond", "however", "but", "everything", "selves", "know", "amidst", "t", "wed", "nobody", "we'd", "side", "shan't", "ending", "seemed", "specify", "than", "somebody", "gave", "whatever", "resulted", "dare", "page", "keys", "farther", "okay", "d", "so", "resulting", "abroad", "obtained", "arise", "follows", "exactly", "substantially", "there'll", "here's", "unlikely", "just", "usually", "nor", "own", "we", "poorly", "primarily", "reasonably", "they", "whence", "bill", "others", "forever", "whereas", "far", "lest", "thereafter", "thereof", "why's", "and", "this", "results", "because", "ignored", "minus", "thanx", "mr", "obtain", "seeing", "thoroughly", "needs", "top", "second", "that've", "is", "thru", "where", "himse”", "whereby", "i've", "recently", "end", "world", "immediately", "somethan", "usefulness", "beforehand", "already", "of", "known", "looking", "que", "try", "shed", "given", "ref", "following", "caption", "j", "you", "awfully", "makes", "arent", "eleven", "home", "wish", "neverf", "eg", "brief", "he", "says", "described", "his", "sincere", "invention", "afterwards", "above", "aside", "found", "l", "thoughh", "ought", "whose", "despite", "does", "up", "don't", "sometime", "in", "by", "placed", "amid", "other", "there've", "necessary", "seem", "used", "herse”", "suggest", "provides", "most", "sure", "shall", "ex", "herself", "none", "indicate", "becomes", "fairly", "c", "contains", "amongst", "make", "means", "if", "give", "throug", "mrs", "h", "id", "done", "able", "ok", "similar", "necessarily", "apparently", "u", "need", "specified", "words", "'ve", "wheres", "whole", "n", "front", "yet", "yourself", "different", "except", "anyways", "may", "within", "you've", "as", "actually", "please", "we've", "im", "each", "its", "tries", "anymore", "forty", "another", "changes", "inward", "last", "how's", "ever", "enough", "i'm", "her", "ah", "theyre", "said", "x", "meantime", "someone", "they'll", "followed", "seeming", "mostly", "many", "around", "hardly", "no", "allow", "computer", "that's", "potentially", "undoing", "then", "haven't", "six", "take", "are", "almost", "eight", "seriously", "howbeit", "thirty", "specifically", "for", "else", "right", "inner", "www", "cry", "say", "o", "hello", "re", "miss", "insofar", "five", "thats", "twice", "omitted", "new", "after", "hes", "itself", "it's", "himself", "un", "myself", "much", "til", "gives", "ups", "useful", "with", "q", "often", "saw", "which", "per", "could", "any", "needn't", "overall", "us", "who's", "over", "they'd", "unlike", "g", "latterly", "sometimes", "goes", "ml", "four", "wants", "largely", "believe", "before", "index", "youre", "saying", "merely", "corresponding", "anybody", "gotten", "happens", "on", "inc", "whod", "when's", "'ll", "perhaps", "when", "comes", "across", "thin", "line", "et-al", "nos", "hi", "round", "hed", "fire", "too", "added", "where's", "ten", "at", "hereupon", "low", "thus", "ones", "i", "amount", "meanwhile", "mine", "significant", "previously", "might", "seems", "widely", "help", "it", "tends", "maybe", "back", "seen", "behind", "youd", "hopefully", "look", "promptly", "hence", "name", "mayn't", "thered", "mainly", "considering", "everyone", "fifteen", "anyone", "recent", "keep", "only", "twenty", "ca", "through", "away", "ltd", "since", "vs", "whos", "e", "tip", "nonetheless", "co.", "section", "self", "affects", "he'd", "secondly", "gets", "com", "couldnt", "certainly", "first", "non", "somehow", "a's", "affecting", "via", "had", "m", "those", "went", "beginning", "according", "lower", "let's", "between", "again", "our", "ninety", "once", "fewer", "he's", "mightn't", "made", "fix", "regards", "upon", "better", "whim", "edu", "under", "relatively", "t's", "th", "mean", "c's", "whom", "accordingly", "from", "your", "regarding", "the", "announce", "begins", "somewhat", "anyway", "million", "three", "definitely", "thank", "cannot", "example", "go", "isn't", "novel", "kept", "to", "toward", "possibly", "hasnt", "successfully", "detail", "hereby", "nearly", "out", "itse”", "taking", "ran", "whether", "backward", "therere", "run", "like", "hasn't", "lately", "wherein", "fify", "ago", "onto", "will", "everybody", "shouldn't", "has", "readily", "whenever", "ask", "anyhow", "how", "forth", "among", "see", "associated", "opposite", "what'll", "along", "little", "while", "adj", "way", "plus", "there's", "states", "getting", "wouldn't", "ord", "such", "wasn't", "whereupon", "couldn't", "inc.", "ahead", "show", "particular", "viz", "stop", "never", "least", "didn't", "it'll", "I", "research", "sent", "specifying", "i'll", "you'd", "furthermore", "seven", "noone", "these", "it'd", "k", "some", "think", "whomever", "mill", "there'd", "we'll", "against", "taken", "took", "mustn't", "every", "hid", "itd", "namely", "neverless", "value", "ain't", "doing", "obviously", "presumably", "anything", "underneath", "former", "well", "ourselves", "till", "pp", "approximately", "into", "theyd", "during", "me", "de", "provided", "were", "gone", "containing", "looks", "whereafter", "one", "sup", "get", "course", "have", "you'll", "regardless", "become", "neither", "no-one", "either", "less", "apart", "fill", "put", "ed", "hadn't", "various", "normally", "shows", "indicates", "doesn't", "directly", "you're", "usefully", "certain", "related", "amoungst", "evermore", "describe", "cant", "who'd", "whilst", "refs", "she'd", "both", "be", "i'd", "use", "shown", "information", "quite", "wherever", "outside", "due", "p", "willing", "adopted", "using", "hither", "do", "likewise", "thereby", "let", "yours", "one's", "indeed", "versus", "thick", "unfortunately", "particularly", "sorry", "thereto", "accordance", "allows", "later", "knows", "nd", "oh", "significantly", "na", "together", "v", "oughtn't", "below", "why", "elsewhere", "ours", "s", "call", "what", "old", "best", "z", "part", "thing", "nay", "can't", "ie", "date", "present", "besides", "affected", "whats", "alongside", "forward", "aren't", "y", "sixty", "that", "sufficiently", "eighty", "zero", "very", "weren't", "who", "someday", "etc", "effect", "whither", "sub", "trying", "third", "things", "pages", "going", "half", "thereupon", "uses", "appropriate", "aren", "come", "appreciate", "noted", "find", "similarly", "vols", "daren't", "hundred", "tell", "they're", "owing", "downwards", "here", "w", "something", "liked", "showns", "state", "herein", "asking", "though", "an", "or", "what've", "clearly", "we're", "km", "likely", "yes", "immediate", "nothing", "otherwise", "con", "was", "towards", "proud", "concerning", "system", "inasmuch", "formerly", "although", "all", "anywhere", "sec", "therefore", "alone", "really", "act", "latter", "especially", "even", "past", "their", "co", "inside", "heres", "a", "instead", "that'll", "f", "backwards", "empty", "always", "him", "more", "briefly", "quickly", "available", "lets", "consequently", "contain", "unto", "twelve", "next", "whoever", "tried", "got", "my", "r", "what's", "b", "mug", "themselves", "whichever", "won't", "hereafter", "them", "kg", "wonder", "beside", "can", "importance", "auth", "mg", "indicated", "there're", "thanks", "nevertheless", "currently", "became", "appear", "down", "moreover", "probably", "respectively", "been", "hers", "without", "move", "showed", "must", "truly", "theirs", "thousand", "serious", "thence", "begin", "near", "nine", "did", "sensible", "thorough", "somewhere", "fifth", "possible", "unless", "ts", "further", "there", "am", "they've", "interest", "predominantly", "strongly", "welcome", "therein", "came", "bottom", "being", "c'mon", "consider", "greetings", "he'll", "until", "upwards", "thou", "shes", "want", "now", "she", "entirely", "not", "qv", "soon", "should", "doi", "preprint", "copyright", "org", "https", "et", "al", "author", "figure", "table", "rights", "reserved", "permission", "use", "used", "using", "biorxiv", "medrxiv", "license", "fig", "fig.", "al.", "+", "II", "III", "Å")
    assert(result === expected)
  }

  test("should load corona stop words correctly") {
    val result = inputdataLoader.loadCoronaStopWords()

    val expected = Array("cell", "infection", "infectious", "infect", "virus", "viral", "Viral", "COVID", "coronavirus", "respiratory", "disease", "pandemic", "epidemic", "outbreak", "study", "report", "review", "case", "result", "data", "dataset", "test", "sample", "model", "include", "observe", "increase", "high", "individual", "group", "human", "patient", "year", "month", "time", "day")
    assert(result === expected)
  }

  test("should load smoking words correctly") {
    val result = inputdataLoader.loadSmokingWords()

    val expected = Array("smoke", "cigar", "fire", "puff", "tobacco", "cigarette", "fume", "smog", "pot", "vapor", "vape", "cannabis", "weed")
    assert(result === expected)
  }
}
